	<html>
		<head>
		<script>
var points = [0,0,0,0],fromFullAddress,toFullAddress;

function doGeocode(address) {
	var xmlhttp;
	xmlhttp = new XMLHttpRequest();
	xmlhttp.onreadystatechange = function() {
		if (this.readyState == 4 && this.status == 200) {
			var jsonResponse = JSON.parse(this.responseText);
			document.getElementById("match" + address).innerHTML = jsonResponse.features[0].properties.fullAddress + " (" 
					+ jsonResponse.features[0].geometry.coordinates[1] + ", " 
					+ jsonResponse.features[0].geometry.coordinates[0] + ")";
			if(address == "From") {
				points[0] = jsonResponse.features[0].geometry.coordinates[0];
				points[1] = jsonResponse.features[0].geometry.coordinates[1];
        fromFullAddress = jsonResponse.features[0].properties.fullAddress;
			} else if(address == "To") {
				points[2] = jsonResponse.features[0].geometry.coordinates[0];
				points[3] = jsonResponse.features[0].geometry.coordinates[1];
        toFullAddress = jsonResponse.features[0].properties.fullAddress;
			}
			document.getElementById("points").value = points[0] + "," + points[1] + "," + points[2] + "," + points[3];
      document.getElementById("routeDescription").value = fromFullAddress + " to " + toFullAddress
		}
	};
	xmlhttp.open("GET", "http://apps.gov.bc.ca/pub/geocoder/addresses.json?addressString=" + document.getElementById('addressString' + address).value, true);
	xmlhttp.send();
}
		</script>
		</head>
		<body>
      <p><b>Find route and directions between two addresses</b><br>
               <i>Uses BC Physical Address Geocoder and BC Route Planner.</i><br></p>
			 <table width="63%" border="0" cellpadding="4" cellspacing="0">
				<tr>
					<form action="javascript:doGeocode('From');">
						<td align="left">
							From:
						</td>
						<td>
							<input type="text" id="addressStringFrom" size="45"/>
						</td>
						<td>
							<input type="submit" id="GeocodeFromButton" value="Geocode"/>
						</td>
					</form>
				</tr>
				<tr>
					<td colspan="3" id="matchFrom">&nbsp;
					</td>
				</tr>
				<tr>
					<form action="javascript:doGeocode('To');">
						<td align="left">
							To:
						</td>
						<td>
							<input type="text" id="addressStringTo" size="45"/>
						</td>
						<td>
							<input type="submit" id="GeocodeToButton" value="Geocode"/>
						</td>
					</form>
				</tr>
				<tr>
					<td colspan="3" id="matchTo">&nbsp;
					</td>
				</tr>
				<tr>
					<form action="https://routertst.api.gov.bc.ca/directions.kml?" target="route" id="route" method="get" autocomplete="on">
          		<input type="hidden" name="points" id="points" value=""/>
							<input type="hidden" name="outputSRS" id="outputSRS" value="4326"/>
              <input type="hidden" name="routeDescription" id="routeDescription" value="Routing results"/>

            <tr>
               <td colspan="3">
                        API Key: <input type="text" name="apikey" id="apiKey"/>
              </td>
            </tr>

            <tr>
               <td colspan="3">
                        Criteria: <input type="radio" name="criteria" value="fastest" checked="checked"/>fastest
                                  <input type="radio" name="criteria" value="shortest"/>shortest
              </td>
            </tr>

            <tr>
               <td colspan="3">
               				  Distance Unit:<input type="radio" name="distanceUnit" value="km" checked="checked"/>metric
							                        <input type="radio" name="distanceUnit" value="mi"/>imperial
              </td>
            </tr>
            
            <tr>
						  <td colspan="3">
							   <input type="submit" value="Find Route and Directions"/>
						  </td>
            </tr>

					</form>
				</tr>
			</table>
		</body>
	</html>
